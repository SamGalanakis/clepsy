global:
  scrape_interval: 10s
  evaluation_interval: 10s
  scrape_timeout: 8s

# Optional: external labels if you plan to federate
# external_labels:
#   env: dev
#   stack: clepsy

scrape_configs:
  # Prometheus itself
  - job_name: prometheus
    static_configs:
      - targets: ["prometheus:9090"]

  # Clepsy FastAPI app (expose /metrics in your app)
  - job_name: clepsy
    metrics_path: /metrics
    static_configs:
      - targets: ["clepsy:8000"]

  # Dramatiq worker (built-in Prometheus middleware, port 9191)
  - job_name: dramatiq_worker
    metrics_path: /metrics
    static_configs:
      - targets: ["dramatiq-worker:9191"]

  # Valkey (Redis) exporter
  - job_name: valkey
    static_configs:
      - targets: ["valkey-exporter:9121"]

# Optional rule files
# rule_files:
#   - /etc/prometheus/rules/*.yml
